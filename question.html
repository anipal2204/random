<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>A Question</title>
  <style>
    :root{ 
      --ink:#1f2937; 
      --card:#ffffff; 
      --shadow:0 18px 50px rgba(0,0,0,.12),0 8px 18px rgba(0,0,0,.06); 
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    html,body{ height:100%; }

    body{
      font:16px/1.5 system-ui, Segoe UI, Roboto, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--ink);
      display:grid;
      place-items:center;
      position:relative;
      overflow:hidden;
      cursor: url("data:image/svg+xml;utf8,\
        <svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'>\
          <circle cx='12' cy='12' r='10' fill='none' stroke='%238b5cf6' stroke-width='2'/>\
          <circle cx='12' cy='12' r='3' fill='%238b5cf6'/>\
        </svg>") 12 12, pointer;
    }

    /* Blurred + dim background image */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: url('exp2.jpg') center center / cover no-repeat fixed;
      filter: blur(1px) brightness(0.7);
      transform: scale(1.03); /* avoids edge lines when blurring */
      z-index: -1;
    }

    .card{
      background: var(--card);
      width:min(720px,92vw);
      border-radius:28px;
      box-shadow:var(--shadow);
      padding:28px 22px;
      text-align:center;
      position:relative;
      overflow:hidden;
    }
      
    h1{margin:6px 0 14px; font-size:clamp(22px,4.6vw,32px)}
    .btns{display:flex; gap:12px; justify-content:center; margin-top:12px; flex-wrap:wrap}
    button{
      border:0; border-radius:14px; padding:12px 18px; font-weight:800; letter-spacing:.2px;
      box-shadow:0 10px 24px rgba(0,0,0,.08);
      transition:transform .12s ease, box-shadow .12s ease, filter .12s ease;
      cursor: inherit;
    }
    .yes{background:linear-gradient(180deg,#22c55e,#16a34a); color:#fff}
    .no{background:linear-gradient(180deg,#f43f5e,#be123c); color:#fff}
    button:active{transform:translateY(1px); box-shadow:0 6px 16px rgba(0,0,0,.12)}
    .msg{margin-top:14px; min-height:28px; font-size:18px; opacity:.9}

    .follower{ 
      position:fixed; left:0; top:0; width:64px; height:64px; pointer-events:none;
      transform:translate(-50%,-50%); filter: drop-shadow(0 2px 3px rgba(0,0,0,.25)); z-index:5;
      font-size:56px; line-height:64px; 
    }

    canvas#fx { position:fixed; inset:0; pointer-events:none; z-index:10; }

    .yayToast, .nayToast {
      position: fixed; top: 8%; left: 50%;
      transform: translate(-50%, -12px);
      z-index: 12; pointer-events:none;
      opacity: 0;
      transition: opacity .25s ease, transform .25s ease;
    }
    .yayToast.show, .nayToast.show { opacity: 1; transform: translate(-50%, 0); }

    .yayCard, .nayCard {
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 18px 50px rgba(0,0,0,.18), 0 8px 18px rgba(0,0,0,.08);
      padding: 14px 18px;
      display: inline-flex; align-items: center; gap: 10px;
      font-weight: 800;
    }
    .yayCard .emoji{ font-size: 26px }
    .yayCard .text{ font-size: clamp(16px, 3.6vw, 20px); color:#16a34a }
    .nayCard .emoji{ font-size: 26px }
    .nayCard .text{ font-size: clamp(16px, 3.6vw, 20px); color:#0ea5e9 }

    .rainOverlay{
      position: fixed; inset: 0; display:none; align-items:center; justify-content:center;
      background: transparent; z-index: 11;
      opacity:1; transition: opacity .35s ease;
    }
    .rainOverlay h2{ display:none; }
  </style>
</head>
<body>
  <div class="card">
    <h1 id="question">Do you like this cute chick? üê•</h1>
    <div class="btns">
      <button class="yes" id="yesBtn">Yes</button>
      <button class="no" id="noBtn">No</button>
    </div>
    <div class="msg" id="msg"></div>
  </div>

  <div class="follower" id="follower" aria-hidden="true">üê•</div>
  <canvas id="fx"></canvas>

  <div class="yayToast" id="yayToast">
    <div class="yayCard">
      <span class="emoji">‚ùÑÔ∏è</span>
      <span class="text">Yay, <span id="nameYay">friend</span>!</span>
    </div>
  </div>

  <div class="nayToast" id="nayToast">
    <div class="nayCard">
      <span class="emoji">‚òî</span>
      <span class="text" id="nayText">Okay‚Ä¶ so</span>
    </div>
  </div>

  <div class="rainOverlay" id="rainOverlay"></div>

  <!-- Audio -->
  <audio id="sndNote" src="song.mp3" preload="auto"></audio>
  <audio id="sndVoice" src="voice.mp3" preload="auto"></audio>
  <audio id="sndRain"  src="rain.mp3"  preload="auto" loop></audio>

  <script>
    const userName = localStorage.getItem('userName') || 'friend';
    document.getElementById('question').textContent = `Hey ${userName}, do you like this cute chick? üê•`;
    document.getElementById('nameYay').textContent = userName;

    (function(){
      const el = document.getElementById('follower');
      let x=innerWidth/2, y=innerHeight/2, tx=x, ty=y;
      const offsetX = 30, offsetY = -20;
      const lerp=(a,b,t)=>a+(b-a)*t;
      addEventListener('mousemove', e => { tx = e.clientX + offsetX; ty = e.clientY + offsetY; });
      (function tick(){ x=lerp(x,tx,0.18); y=lerp(y,ty,0.18); el.style.left=x+'px'; el.style.top=y+'px'; requestAnimationFrame(tick);}());
    })();

    const fx = document.getElementById('fx');
    const ctx = fx.getContext('2d');
    const DPR = devicePixelRatio || 1;
    function resize(){ fx.width = innerWidth * DPR; fx.height = innerHeight * DPR; ctx.setTransform(DPR,0,0,DPR,0,0); }
    resize(); addEventListener('resize', resize);

    let snowRunning = false;
    function playSnowContinuous(count=400){
      snowRunning = true;
      const W = innerWidth, H = innerHeight;
      const flakes = Array.from({length:count}, ()=>({
        x: Math.random()*W, y: Math.random()*H,
        r: 2 + Math.random()*5, vy: 0.8 + Math.random()*1.8,
        vx: -0.6 + Math.random()*1.2, drift: Math.random()*Math.PI*2
      }));
      (function frame(){
        if(!snowRunning) return;
        ctx.clearRect(0,0,W,H);
        ctx.shadowBlur = 8; ctx.shadowColor = 'rgba(255,255,255,0.9)';
        for(const p of flakes){
          p.drift += 0.01;
          p.x += p.vx + Math.sin(p.drift)*0.7;
          p.y += p.vy;
          if(p.y > H+8){ p.y = -12; p.x = Math.random()*W; }
          ctx.beginPath(); ctx.fillStyle = 'rgba(255,255,255,0.98)';
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill();
        }
        ctx.shadowBlur = 0;
        requestAnimationFrame(frame);
      })();
    }
    function stopSnow(){ snowRunning = false; ctx.clearRect(0,0,innerWidth,innerHeight); }

    let rainRunning = false;
    function playRain(count=450){
      const W = innerWidth, H = innerHeight;
      const drops = Array.from({length:count}, ()=>({ x: Math.random()*W, y: -Math.random()*H, l: 8 + Math.random()*14, vy: 6 + Math.random()*8 }));
      rainRunning = true;
      (function frame(){
        if(!rainRunning) return;
        ctx.clearRect(0,0,W,H);
        ctx.strokeStyle = 'rgba(14,165,233,0.9)'; ctx.lineWidth = 1; ctx.lineCap = 'round';
        for(const d of drops){
          ctx.beginPath(); ctx.moveTo(d.x, d.y); ctx.lineTo(d.x, d.y + d.l); ctx.stroke();
          d.y += d.vy; if(d.y > H){ d.y = -20; d.x = Math.random()*W; }
        }
        requestAnimationFrame(frame);
      })();
    }
    function stopRain(){ rainRunning = false; ctx.clearRect(0,0,innerWidth,innerHeight); }

    const yesBtn = document.getElementById('yesBtn');
    const noBtn  = document.getElementById('noBtn');
    const yayToast = document.getElementById('yayToast');
    const nayToast = document.getElementById('nayToast');
    const nayText  = document.getElementById('nayText');
    const rainOverlay = document.getElementById('rainOverlay');
    const sndNote  = document.getElementById('sndNote');
    const sndVoice = document.getElementById('sndVoice');
    const sndRain  = document.getElementById('sndRain');

    const noMessages = [
      "Are you sure? üò≥","Really really sure? ü•∫","But look at that tiny beak! üê£",
      "What if it chirps just for you? üé∂","Okay‚Ä¶ maybe think again? ü§î",
      "One last chance‚Ä¶ pretty please? üôè","Cuckoo will be sad üò¢",
      "Super last last chance! ü´£","Fine‚Ä¶ I accept your no. (‚Ä¶but then hear out Cuckoo)"
    ];
    let noIndex = 0;
    let celebrating = false, allowRestart = false;

    yesBtn.addEventListener('click', (e)=>{
      e.stopPropagation();
      try { sndNote.currentTime = 0; sndNote.play().catch(()=>{}); } catch(_){}
      playSnowContinuous(420);
      yayToast.classList.add('show');
      yesBtn.disabled=true; noBtn.disabled=true;
      yesBtn.style.filter='grayscale(.5)'; noBtn.style.filter='grayscale(.5)';
      celebrating = true; setTimeout(()=> allowRestart = true, 400);
    });

    noBtn.addEventListener('click', (e)=>{
      e.stopPropagation();
      const msgEl = document.getElementById('msg');
      msgEl.textContent = noMessages[noIndex];
      if(noIndex >= noMessages.length - 1){
        nayText.textContent = "Okay‚Ä¶ so";
        nayToast.classList.add('show');
        rainOverlay.style.display = 'flex';
        try{ sndRain.volume = 0.4; sndRain.play().catch(()=>{}); }catch(_){}
        try{ sndVoice.currentTime = 0; sndVoice.play().catch(()=>{}); }catch(_){}
        playRain(520);
        sndVoice.addEventListener('ended', ()=> document.body.addEventListener('click', resetOnce, { once:true }), { once:true });
      }
      noIndex = Math.min(noIndex + 1, noMessages.length - 1);
    });

    function resetOnce(){
      try { sndNote.pause(); sndNote.currentTime = 0; } catch(_){}
      nayToast.classList.remove('show');
      rainOverlay.style.opacity = '0';
      setTimeout(()=>{
        stopRain();
        try{ sndRain.pause(); sndRain.currentTime = 0; }catch(_){}
        rainOverlay.style.display = 'none';
        location.reload();
      }, 400);
    }

    document.body.addEventListener('click', ()=>{
      if(celebrating && allowRestart){
        yayToast.classList.remove('show');
        stopSnow();
        try { sndNote.pause(); sndNote.currentTime = 0; } catch(_){}
        setTimeout(()=> location.reload(), 200);
      }
    });
  </script>
</body>
</html>
